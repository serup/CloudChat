	
	/*
		Copyright (c) 2010-2013 Liquid Working Group. All Rights Reserved.
		Available on MIT license (see: http://www.jsliquid.com/license.html)
	*/
	
	jsl.__ploads.crypto='try{jsl}catch(e){throw Error("liquid(error) >> [Crypto] module not loaded - cause: jsl core not found")}if(!jsl||jsl.__magic!=="J345NN48H756PQ56"){throw Error("liquid(error) >> [Crypto] module not loaded - cause: jsl core not found (bad magic number)")}if(!jsl.__ready){throw Error("liquid(error) >> [Crypto] module not loaded - cause: previous jsl core error")}if(jsl.__mods.crypto){jsl.console.warn("[Crypto] module already loaded")}if(!jsl.__mods.crypto){jsl.__mods.push("crypto");jsl.__mods.crypto="0.82";if(jsl.__mods.crypto!==jsl.__version){throw jsl.ConfigError("BadVersion",["Crypto module",jsl.__mods.crypto,jsl.__version])}jsl.Crypto=(function(){try{var d,c,g;jsl.require("data");d=new jsl.Module("jsl.Crypto");g=jsl.Data.Blob;d.__md5_r=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];c=[];for(var b=0;b<64;b++){c[b]=Math.floor(Math.abs(Math.sin(b+1))*Math.pow(2,32))>>0}d.__md5_k=c;d.__sha256_k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];d.__sha512_k=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]];d.aes={__name:"jsl.Crypto.aes"};d.aes.__sbx=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];d.aes.__sbxi=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];d.aes.__2=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,160,162,164,166,168,170,172,174,176,178,180,182,184,186,188,190,192,194,196,198,200,202,204,206,208,210,212,214,216,218,220,222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,27,25,31,29,19,17,23,21,11,9,15,13,3,1,7,5,59,57,63,61,51,49,55,53,43,41,47,45,35,33,39,37,91,89,95,93,83,81,87,85,75,73,79,77,67,65,71,69,123,121,127,125,115,113,119,117,107,105,111,109,99,97,103,101,155,153,159,157,147,145,151,149,139,137,143,141,131,129,135,133,187,185,191,189,179,177,183,181,171,169,175,173,163,161,167,165,219,217,223,221,211,209,215,213,203,201,207,205,195,193,199,197,251,249,255,253,243,241,247,245,235,233,239,237,227,225,231,229];d.aes.__3=[0,3,6,5,12,15,10,9,24,27,30,29,20,23,18,17,48,51,54,53,60,63,58,57,40,43,46,45,36,39,34,33,96,99,102,101,108,111,106,105,120,123,126,125,116,119,114,113,80,83,86,85,92,95,90,89,72,75,78,77,68,71,66,65,192,195,198,197,204,207,202,201,216,219,222,221,212,215,210,209,240,243,246,245,252,255,250,249,232,235,238,237,228,231,226,225,160,163,166,165,172,175,170,169,184,187,190,189,180,183,178,177,144,147,150,149,156,159,154,153,136,139,142,141,132,135,130,129,155,152,157,158,151,148,145,146,131,128,133,134,143,140,137,138,171,168,173,174,167,164,161,162,179,176,181,182,191,188,185,186,251,248,253,254,247,244,241,242,227,224,229,230,239,236,233,234,203,200,205,206,199,196,193,194,211,208,213,214,223,220,217,218,91,88,93,94,87,84,81,82,67,64,69,70,79,76,73,74,107,104,109,110,103,100,97,98,115,112,117,118,127,124,121,122,59,56,61,62,55,52,49,50,35,32,37,38,47,44,41,42,11,8,13,14,7,4,1,2,19,16,21,22,31,28,25,26];d.aes.__9=[0,9,18,27,36,45,54,63,72,65,90,83,108,101,126,119,144,153,130,139,180,189,166,175,216,209,202,195,252,245,238,231,59,50,41,32,31,22,13,4,115,122,97,104,87,94,69,76,171,162,185,176,143,134,157,148,227,234,241,248,199,206,213,220,118,127,100,109,82,91,64,73,62,55,44,37,26,19,8,1,230,239,244,253,194,203,208,217,174,167,188,181,138,131,152,145,77,68,95,86,105,96,123,114,5,12,23,30,33,40,51,58,221,212,207,198,249,240,235,226,149,156,135,142,177,184,163,170,236,229,254,247,200,193,218,211,164,173,182,191,128,137,146,155,124,117,110,103,88,81,74,67,52,61,38,47,16,25,2,11,215,222,197,204,243,250,225,232,159,150,141,132,187,178,169,160,71,78,85,92,99,106,113,120,15,6,29,20,43,34,57,48,154,147,136,129,190,183,172,165,210,219,192,201,246,255,228,237,10,3,24,17,46,39,60,53,66,75,80,89,102,111,116,125,161,168,179,186,133,140,151,158,233,224,251,242,205,196,223,214,49,56,35,42,21,28,7,14,121,112,107,98,93,84,79,70];d.aes.__B=[0,11,22,29,44,39,58,49,88,83,78,69,116,127,98,105,176,187,166,173,156,151,138,129,232,227,254,245,196,207,210,217,123,112,109,102,87,92,65,74,35,40,53,62,15,4,25,18,203,192,221,214,231,236,241,250,147,152,133,142,191,180,169,162,246,253,224,235,218,209,204,199,174,165,184,179,130,137,148,159,70,77,80,91,106,97,124,119,30,21,8,3,50,57,36,47,141,134,155,144,161,170,183,188,213,222,195,200,249,242,239,228,61,54,43,32,17,26,7,12,101,110,115,120,73,66,95,84,247,252,225,234,219,208,205,198,175,164,185,178,131,136,149,158,71,76,81,90,107,96,125,118,31,20,9,2,51,56,37,46,140,135,154,145,160,171,182,189,212,223,194,201,248,243,238,229,60,55,42,33,16,27,6,13,100,111,114,121,72,67,94,85,1,10,23,28,45,38,59,48,89,82,79,68,117,126,99,104,177,186,167,172,157,150,139,128,233,226,255,244,197,206,211,216,122,113,108,103,86,93,64,75,34,41,52,63,14,5,24,19,202,193,220,215,230,237,240,251,146,153,132,143,190,181,168,163];d.aes.__D=[0,13,26,23,52,57,46,35,104,101,114,127,92,81,70,75,208,221,202,199,228,233,254,243,184,181,162,175,140,129,150,155,187,182,161,172,143,130,149,152,211,222,201,196,231,234,253,240,107,102,113,124,95,82,69,72,3,14,25,20,55,58,45,32,109,96,119,122,89,84,67,78,5,8,31,18,49,60,43,38,189,176,167,170,137,132,147,158,213,216,207,194,225,236,251,246,214,219,204,193,226,239,248,245,190,179,164,169,138,135,144,157,6,11,28,17,50,63,40,37,110,99,116,121,90,87,64,77,218,215,192,205,238,227,244,249,178,191,168,165,134,139,156,145,10,7,16,29,62,51,36,41,98,111,120,117,86,91,76,65,97,108,123,118,85,88,79,66,9,4,19,30,61,48,39,42,177,188,171,166,133,136,159,146,217,212,195,206,237,224,247,250,183,186,173,160,131,142,153,148,223,210,197,200,235,230,241,252,103,106,125,112,83,94,73,68,15,2,21,24,59,54,33,44,12,1,22,27,56,53,34,47,100,105,126,115,80,93,74,71,220,209,198,203,232,229,242,255,180,185,174,163,128,141,154,151];d.aes.__E=[0,14,28,18,56,54,36,42,112,126,108,98,72,70,84,90,224,238,252,242,216,214,196,202,144,158,140,130,168,166,180,186,219,213,199,201,227,237,255,241,171,165,183,185,147,157,143,129,59,53,39,41,3,13,31,17,75,69,87,89,115,125,111,97,173,163,177,191,149,155,137,135,221,211,193,207,229,235,249,247,77,67,81,95,117,123,105,103,61,51,33,47,5,11,25,23,118,120,106,100,78,64,82,92,6,8,26,20,62,48,34,44,150,152,138,132,174,160,178,188,230,232,250,244,222,208,194,204,65,79,93,83,121,119,101,107,49,63,45,35,9,7,21,27,161,175,189,179,153,151,133,139,209,223,205,195,233,231,245,251,154,148,134,136,162,172,190,176,234,228,246,248,210,220,206,192,122,116,102,104,66,76,94,80,10,4,22,24,50,60,46,32,236,226,240,254,212,218,200,198,156,146,128,142,164,170,184,182,12,2,16,30,52,58,40,38,124,114,96,110,68,74,88,86,55,57,43,37,15,1,19,29,71,73,91,85,127,113,99,109,215,217,203,197,239,225,243,253,167,169,187,181,159,145,131,141];d.aes.__rc=[0,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];d.addOption("hmac");d.addOption("hmac.hash",{dvalue:"sha1",setter:function(a,h,i){/*!*/jsl.validate(a,"si(sha1,md5)",i);/*!*/return a.toLowerCase()}});d.addOption("key");d.addOption("key.salt",{dvalue:new g("www.jsliquid.com"),setter:function(a,h,i){/*!*/jsl.validate(a,"t(s+,al,Blob)",i);if(!g.toArray(a).length){throw jsl.ParamError("BadValue:"+i)}/*!*/return new g(a)}});d.addOption("key.count",{dvalue:100,setter:function(a,h,i){/*!*/jsl.validate(a,"i[1,4294967295]",i);/*!*/return +a}});d.addOption("key.size",{dvalue:16,setter:function(a,h,i){/*!*/jsl.validate(a,"i[1,1310700]",i);/*!*/return +a}});d.addOption("aes");d.addOption("aes.mode",{dvalue:"CTR",setter:function(a,h,i){/*!*/jsl.validate(a,"si(ECB,CBC,CFB,OFB,CTR)",i);/*!*/return a.toUpperCase()}});d.addOption("aes.padding",{dvalue:"pkcs7",setter:function(a,h,i){/*!*/jsl.validate(a,"si(pkcs7,ansiX923,iso10126,zero,no)",i);/*!*/return a.toLowerCase()}});d.addOption("aes.iv",{dvalue:new g("www.jsliquid.com"),setter:function(a,h,i){/*!*/jsl.validate(a,"t(s+,al,Blob)",i);/*!*/return new g(a)}});d.addOption("aes.size",{dvalue:128,setter:function(a,h,i){/*!*/jsl.validate(a,"ns(128,192,256)",i);/*!*/return +a}});jsl.setMessage("crypto.aes.EmptyKey","<key> empty key");jsl.setMessage("crypto.aes.DecryptError","decryption failed. One or more AES options are not the same specified at encryption time");jsl.setMessage("crypto.aes.BadPadding","impossible encrypt the current message in $ mode without execute a padding because the message size is not a multiple of 16 bytes");return d}catch(f){jsl.throwError(f,"jsl.Crypto")}})();jsl.Crypto.md5=function(F){try{var E,D,C,B,z,y,t,q,p,s,x,G,v,h,o,n,m,j,i;/*!*/if(arguments.length!==1){throw jsl.ParamError()}jsl.validate(F,"t[s,al,Blob]","data");/*!*/t=jsl.Data.Blob.toArray(F);s=this.__md5_r;x=this.__md5_k;h=t.length*8;for(v=h+1;v-~~(v/512)*512!==448;v++){}v/=8;t[t.length]=128;t[v]=h&255;t[v+1]=h>>8&255;t[v+2]=h>>16&255;t[v+3]=h>>>24;o=1732584193;n=4023233417;m=2562383102;j=271733878;for(var w=0;w<v;w+=64){E=o;D=n;C=m;B=j;for(var u=0;u<64;u++){if(u<16){z=((D&C)|(~D&B))>>>0;y=4*u}else{if(u<32){z=((B&D)|(~B&C))>>>0;y=4*((5*u+1)%16)}else{if(u<48){z=(D^C^B)>>>0;y=4*((3*u+5)%16)}else{z=(C^(D|~B))>>>0;y=4*((7*u)%16)}}}q=B;B=C;C=D;p=w+y;i=(t[p]|t[p+1]<<8|t[p+2]<<16|t[p+3]<<24)>>>0;G=E+z+x[u]+i;D=(D+((G<<s[u]|G>>>(32-s[u]))))>>>0;E=q}o+=E;n+=D;m+=C;j+=B}t=[o&255,o>>8&255,o>>16&255,o>>>24,n&255,n>>8&255,n>>16&255,n>>>24,m&255,m>>8&255,m>>16&255,m>>>24,j&255,j>>8&255,j>>16&255,j>>>24];return new jsl.Data.Blob(t)}catch(A){jsl.throwError(A,this,arguments)}};jsl.Crypto.sha1=function(F){try{var C,g,u,p,o,m,j,h,x,t,s,q,E,D,B,A,z,r,y,v;/*!*/if(arguments.length!==1){throw jsl.ParamError()}jsl.validate(F,"t(s,al,Blob)","data");/*!*/C=jsl.Data.Blob.toArray(F);g=C.length*8;for(u=g+1;u-~~(u/512)*512!==448;u++){}u/=8;C[C.length]=128;C[u+4]=g>>>24;C[u+5]=g>>>16&255;C[u+6]=g>>>8&255;C[u+7]=g&255;p=1732584193;o=4023233417;m=2562383102;j=271733878;h=3285377520;q=[];for(x=0;x<u;x+=64){r=x+64;for(t=x,s=0;t<r;t+=4){q[s++]=(C[t]<<24|C[t+1]<<16|C[t+2]<<8|C[t+3])>>>0}for(;s<80;s++){q[s]=q[s-3]^q[s-8]^q[s-14]^q[s-16];q[s]=(q[s]<<1|q[s]>>>31)>>>0}E=p;D=o;B=m;A=j;z=h;for(t=0;t<80;t++){if(t<20){y=D&B|~D&A;v=1518500249}else{if(t<40){y=D^B^A;v=1859775393}else{if(t<60){y=D&B|D&A|B&A;v=2400959708}else{y=D^B^A;v=3395469782}}}r=((E<<5|E>>>27)>>>0)+(y>>>0)+z+v+q[t];z=A;A=B;B=(D<<30|D>>>2)>>>0;D=E;E=r>>>0}p+=E;o+=D;m+=B;j+=A;h+=z}return new jsl.Data.Blob([p>>>24,p>>>16&255,p>>8&255,p&255,o>>>24,o>>>16&255,o>>8&255,o&255,m>>>24,m>>>16&255,m>>8&255,m&255,j>>>24,j>>>16&255,j>>8&255,j&255,h>>>24,h>>>16&255,h>>8&255,h&255])}catch(z){jsl.throwError(z,this,arguments)}};jsl.Crypto.sha224=function(a){try{this.__sha224=true;return this.__sha256.apply(this,arguments)}catch(b){jsl.throwError(b,this,arguments)}};jsl.Crypto.sha256=function(a){try{this.__sha224=false;return this.__sha256.apply(this,arguments)}catch(b){jsl.throwError(b,this,arguments)}};jsl.Crypto.__sha256=function(R){var P,j,F,x,v,u,t,s,r,q,p,H,D,C,A,Q,O,N,M,L,K,J,I,z,y,G,o,m,B,E;/*!*/if(arguments.length!==1){throw jsl.ParamError()}jsl.validate(R,"t(s,al,Blob)","data");/*!*/P=jsl.Data.Blob.toArray(R);j=P.length*8;for(F=j+1;F-~~(F/512)*512!==448;F++){}F/=8;P[P.length]=128;P[F+4]=j>>>24;P[F+5]=j>>>16&255;P[F+6]=j>>>8&255;P[F+7]=j&255;E=this.__sha224;if(E){x=3238371032;v=914150663;u=812702999;t=4144912697;s=4290775857;r=1750603025;q=1694076839;p=3204075428}else{x=1779033703;v=3144134277;u=1013904242;t=2773480762;s=1359893119;r=2600822924;q=528734635;p=1541459225}G=this.__sha256_k;A=[];for(H=0;H<F;H+=64){B=H+64;for(D=H,C=0;D<B;D+=4){A[C++]=(P[D]<<24|P[D+1]<<16|P[D+2]<<8|P[D+3])>>>0}for(;C<64;C++){z=A[C-15];y=A[C-2];o=(z>>>7|z<<25)^(z>>>18|z<<14)^z>>>3;m=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10;A[C]=(A[C-16]+(o>>>0)+A[C-7]+(m>>>0))>>>0}Q=x;O=v;N=u;M=t;L=s;K=r;J=q;I=p;for(D=0;D<64;D++){o=((Q>>>2|Q<<30)^(Q>>>13|Q<<19)^(Q>>>22|Q<<10))>>>0;m=((L>>>6|L<<26)^(L>>>11|L<<21)^(L>>>25|L<<7))>>>0;z=(I+m+((L&K^~L&J)>>>0)+G[D]+A[D])>>>0;y=(o+(Q&O^Q&N^O&N)>>>0)>>>0;I=J;J=K;K=L;L=M+z;M=N;N=O;O=Q;Q=z+y}x+=Q;v+=O;u+=N;t+=M;s+=L;r+=K;q+=J;p+=I}I=[x>>>24,x>>>16&255,x>>8&255,x&255,v>>>24,v>>>16&255,v>>8&255,v&255,u>>>24,u>>>16&255,u>>8&255,u&255,t>>>24,t>>>16&255,t>>8&255,t&255,s>>>24,s>>>16&255,s>>8&255,s&255,r>>>24,r>>>16&255,r>>8&255,r&255,q>>>24,q>>>16&255,q>>8&255,q&255];if(!E){I.push(p>>>24,p>>>16&255,p>>8&255,p&255)}return new jsl.Data.Blob(I)};jsl.Crypto.sha384=function(a){try{this.__sha384=true;return this.__sha512.apply(this,arguments)}catch(b){jsl.throwError(b,this,arguments)}};jsl.Crypto.sha512=function(a){try{this.__sha384=false;return this.__sha512.apply(this,arguments)}catch(b){jsl.throwError(b,this,arguments)}};jsl.Crypto.__sha512=function(S){var P,m,F,z,y,x,v,u,s,r,q,H,E,D,B,Q,O,N,M,L,C,K,J,I,A,G,t,j,T,R,p,o;/*!*/if(arguments.length!==1){throw jsl.ParamError()}jsl.validate(S,"t(s,al,Blob)","data");/*!*/P=jsl.Data.Blob.toArray(S);m=P.length*8;for(F=m+1;F-~~(F/1024)*1024!==896;F++){}F/=8;P[P.length]=128;P[F+12]=m>>>24;P[F+13]=m>>>16&255;P[F+14]=m>>>8&255;P[F+15]=m&255;t=this.__sha384;if(t){z=[3418070365,3238371032];y=[1654270250,914150663];x=[2438529370,812702999];v=[355462360,4144912697];u=[1731405415,4290775857];s=[2394180231,1750603025];r=[3675008525,1694076839];q=[1203062813,3204075428]}else{z=[1779033703,4089235720];y=[3144134277,2227873595];x=[1013904242,4271175723];v=[2773480762,1595750129];u=[1359893119,2917565137];s=[2600822924,725511199];r=[528734635,4215389547];q=[1541459225,327033209]}G=this.__sha512_k;B=[];j=[];T=[];R=[];A=[];for(H=0;H<F;H+=128){C=H+128;for(E=H,D=0;E<C;E+=8){B[D++]=[P[E+0]<<24|P[E+1]<<16|P[E+2]<<8|P[E+3],P[E+4]<<24|P[E+5]<<16|P[E+6]<<8|P[E+7]]}for(;D<80;D++){p=B[D-15][0];o=B[D-15][1];j[0]=(o<<31|p>>>1)^(o<<24|p>>>8)^p>>>7;j[1]=(p<<31|o>>>1)^(p<<24|o>>>8)^(p<<25|o>>>7);j[0]>>>=NaN;j[1]>>>=NaN;p=B[D-2][0];o=B[D-2][1];T[0]=(o<<13|p>>>19)^(p<<3|o>>>29)^p>>>6;T[1]=(p<<13|o>>>19)^(o<<3|p>>>29)^(p<<26|o>>>6);T[0]>>>=NaN;T[1]>>>=NaN;R[0]=j[0]+T[0]>>>NaN;R[1]=j[1]+T[1]>>>NaN;if(R[1]<j[1]||R[1]<T[1]){R[0]=++R[0]>>>NaN}T[0]=R[0]+B[D-7][0]>>>NaN;T[1]=R[1]+B[D-7][1]>>>NaN;if(T[1]<R[1]||T[1]<B[D-7][1]){T[0]=++T[0]>>>NaN}B[D]=B[D]||[];B[D][0]=T[0]+B[D-16][0]>>>NaN;B[D][1]=T[1]+B[D-16][1]>>>NaN;if(B[D][1]<T[1]||B[D][1]<B[D-16][1]){B[D][0]=++B[D][0]>>>NaN}}Q=[z[0],z[1]];O=[y[0],y[1]];N=[x[0],x[1]];M=[v[0],v[1]];L=[u[0],u[1]];K=[s[0],s[1]];J=[r[0],r[1]];I=[q[0],q[1]];for(E=0;E<80;E++){j[0]=L[0]&K[0]^~L[0]&J[0];j[1]=L[1]&K[1]^~L[1]&J[1];j[0]>>>=NaN;j[1]>>>=NaN;T[0]=(L[1]<<18|L[0]>>>14)^(L[1]<<14|L[0]>>>18)^(L[0]<<23|L[1]>>>9);T[1]=(L[0]<<18|L[1]>>>14)^(L[0]<<14|L[1]>>>18)^(L[1]<<23|L[0]>>>9);T[0]>>>=NaN;T[1]>>>=NaN;R[0]=j[0]+T[0]>>>NaN;R[1]=j[1]+T[1]>>>NaN;if(R[1]<j[1]||R[1]<T[1]){R[0]=(R[0]+1)>>>NaN}j[0]=R[0]+I[0]>>>NaN;j[1]=R[1]+I[1]>>>NaN;if(j[1]<R[1]||j[1]<I[1]){j[0]=++j[0]>>>NaN}T[0]=j[0]+G[E][0]>>>NaN;T[1]=j[1]+G[E][1]>>>NaN;if(T[1]<j[1]||T[1]<G[E][1]){T[0]=++T[0]>>>NaN}A[0]=T[0]+B[E][0]>>>NaN;A[1]=T[1]+B[E][1]>>>NaN;if(A[1]<T[1]||A[1]<B[E][1]){A[0]=++A[0]>>>NaN}j[0]=(Q[0]&O[0]^Q[0]&N[0]^O[0]&N[0]);j[1]=(Q[1]&O[1]^Q[1]&N[1]^O[1]&N[1]);j[0]>>>=NaN;j[1]>>>=NaN;T[0]=((Q[1]<<4|Q[0]>>>28)^(Q[0]<<30|Q[1]>>>2)^(Q[0]<<25|Q[1]>>>7));T[1]=((Q[0]<<4|Q[1]>>>28)^(Q[1]<<30|Q[0]>>>2)^(Q[1]<<25|Q[0]>>>7));T[0]>>>=NaN;T[1]>>>=NaN;I=J;J=K;K=L;L=[M[0]+A[0]>>>NaN,M[1]+A[1]>>>NaN];if(L[1]<M[1]||L[1]<A[1]){L[0]=++L[0]>>>NaN}M=N;N=O;O=Q;p=[A[0]+T[0]>>>NaN,A[1]+T[1]>>>NaN];if(p[1]<A[1]||p[1]<T[1]){p[0]=++p[0]>>>NaN}Q=[p[0]+j[0]>>>NaN,p[1]+j[1]>>>NaN];if(Q[1]<p[1]||Q[1]<j[1]){Q[0]=++Q[0]>>>NaN}}j[0]=z[0]>>>NaN;j[1]=z[1]>>>NaN;z=[j[0]+Q[0]>>>NaN,j[1]+Q[1]>>>NaN];if(z[1]<j[1]||z[1]<Q[1]){z[0]=++z[0]>>>NaN}j[0]=y[0]>>>NaN;j[1]=y[1]>>>NaN;y=[j[0]+O[0]>>>NaN,j[1]+O[1]>>>NaN];if(y[1]<j[1]||y[1]<O[1]){y[0]=++y[0]>>>NaN}j[0]=x[0]>>>NaN;j[1]=x[1]>>>NaN;x=[j[0]+N[0]>>>NaN,j[1]+N[1]>>>NaN];if(x[1]<j[1]||x[1]<N[1]){x[0]=++x[0]>>>NaN}j[0]=v[0]>>>NaN;j[1]=v[1]>>>NaN;v=[j[0]+M[0]>>>NaN,j[1]+M[1]>>>NaN];if(v[1]<j[1]||v[1]<M[1]){v[0]=++v[0]>>>NaN}j[0]=u[0]>>>NaN;j[1]=u[1]>>>NaN;u=[j[0]+L[0]>>>NaN,j[1]+L[1]>>>NaN];if(u[1]<j[1]||u[1]<L[1]){u[0]=++u[0]>>>NaN}j[0]=s[0]>>>NaN;j[1]=s[1]>>>NaN;s=[j[0]+K[0]>>>NaN,j[1]+K[1]>>>NaN];if(s[1]<j[1]||s[1]<K[1]){s[0]=++s[0]>>>NaN}j[0]=r[0]>>>NaN;j[1]=r[1]>>>NaN;r=[j[0]+J[0]>>>NaN,j[1]+J[1]>>>NaN];if(r[1]<j[1]||r[1]<J[1]){r[0]=++r[0]>>>NaN}j[0]=q[0]>>>NaN;j[1]=q[1]>>>NaN;q=[j[0]+I[0]>>>NaN,j[1]+I[1]>>>NaN];if(q[1]<j[1]||q[1]<I[1]){q[0]=++q[0]>>>NaN}}I=[z[0]>>>24,z[0]>>>16&255,z[0]>>8&255,z[0]&255,z[1]>>>24,z[1]>>>16&255,z[1]>>8&255,z[1]&255,y[0]>>>24,y[0]>>>16&255,y[0]>>8&255,y[0]&255,y[1]>>>24,y[1]>>>16&255,y[1]>>8&255,y[1]&255,x[0]>>>24,x[0]>>>16&255,x[0]>>8&255,x[0]&255,x[1]>>>24,x[1]>>>16&255,x[1]>>8&255,x[1]&255,v[0]>>>24,v[0]>>>16&255,v[0]>>8&255,v[0]&255,v[1]>>>24,v[1]>>>16&255,v[1]>>8&255,v[1]&255,u[0]>>>24,u[0]>>>16&255,u[0]>>8&255,u[0]&255,u[1]>>>24,u[1]>>>16&255,u[1]>>8&255,u[1]&255,s[0]>>>24,s[0]>>>16&255,s[0]>>8&255,s[0]&255,s[1]>>>24,s[1]>>>16&255,s[1]>>8&255,s[1]&255];if(!t){I.push(r[0]>>>24,r[0]>>>16&255,r[0]>>8&255,r[0]&255,r[1]>>>24,r[1]>>>16&255,r[1]>>8&255,r[1]&255,q[0]>>>24,q[0]>>>16&255,q[0]>>8&255,q[0]&255,q[1]>>>24,q[1]>>>16&255,q[1]>>8&255,q[1]&255)}return new jsl.Data.Blob(I)};jsl.Crypto.hmac=function(i,p,g){try{var j,f,o,n,m,d;/*!*/if(arguments.length<1||arguments.length>3){throw jsl.ParamError()}jsl.validate(i,"t(s,al,Blob)","data");if(arguments.length===2){jsl.validate(p,"t(s,al,Blob)","key")}if(arguments.length===3){jsl.validate(g,"si(sha1,md5)","hash")}/*!*/j=g?g.toLowerCase():this.getOption("hmac.hash");f=p?jsl.Data.Blob.toArray(p):[];f=f.length>64?this[j](f).__bs:f;d=jsl.Data.Blob.toArray(i);n=[];m=[];for(o=0;o<64;o++){n[o]=f[o]^54;m[o]=f[o]^92}return this[j](m.concat(this[j](n.concat(d)).__bs))}catch(l){jsl.throwError(l,this,arguments)}};jsl.Crypto.key=function(g,i){try{var h,q,z,C,m,B,t,r,u,p,o,A,x,j,y,w,v;/*!*/if(!arguments.length||arguments.length>2){throw jsl.ParamError()}jsl.validate(g,"s+","password");if(arguments.length===2){jsl.validate(i,"t(i++,o)","options")}/*!*/h=jsl.isNumber(i)?{size:i}:(i||{});q=h.salt!=null?h.salt:this.getOption("key.salt");z=h.count!=null?h.count:this.getOption("key.count");C=h.size!=null?h.size:this.getOption("key.size");/*!*/jsl.validate(q,"t(s+,al,Blob)","options.salt");jsl.validate(z,"i[1,4294967295]","options.count");jsl.validate(C,"i[1,1310700]","options.size");/*!*/q=jsl.Data.Blob.toArray(q);/*!*/if(!q.length){throw jsl.ParamError("BadValue:options.salt")}/*!*/q.push(0,0);j=Array.prototype.push;x=q.length;m=[];for(B=A=0,t=g.length;B<t;B++){r=g.charCodeAt(B);if(r>255){m[A++]=r>>>8}m[A++]=r&255}m=m.length>64?this.sha1(m).__bs:m;t=Math.ceil(C/20);u=[];w=[];v=[];for(y=0;y<64;y++){w[y]=m[y]^54;v[y]=m[y]^92}for(B=1;B<=t;B++){q[x]=B>>>8;q[x+1]=B&255;p=o=this.hmac(q,m,"sha1").__bs;for(A=1;A<z;A++){p=this.sha1(v.concat(this.sha1(w.concat(p)).__bs)).__bs;o[0]^=p[0];o[1]^=p[1];o[2]^=p[2];o[3]^=p[3];o[4]^=p[4];o[5]^=p[5];o[6]^=p[6];o[7]^=p[7];o[8]^=p[8];o[9]^=p[9];o[10]^=p[10];o[11]^=p[11];o[12]^=p[12];o[13]^=p[13];o[14]^=p[14];o[15]^=p[15];o[16]^=p[16];o[17]^=p[17];o[18]^=p[18];o[19]^=p[19]}j.apply(u,o)}return new jsl.Data.Blob(u.slice(0,C))}catch(w){jsl.throwError(w,this,arguments)}};jsl.Crypto.aes.encrypt=function(N,O,j){try{var h,z,M,P,m,K,x,E,i,f,B,g,C,F,y,L,D,J,I,H,v,u,t,r,s,q,p,o,A;if(arguments.length<2||arguments.length>3){throw jsl.ParamError()}jsl.validate(N,"t(s,al,Blob)","data");jsl.validate(O,"t(s,al,Blob)","key");if(arguments.length===3){jsl.validate(j,"t(o,i++)","options")}h=jsl.isNumber(j)?{size:j}:(j||{});z=h.size!=null?h.size:jsl.Crypto.getOption("aes.size");M=h.mode!=null?h.mode:jsl.Crypto.getOption("aes.mode");m=h.iv!=null?h.iv:jsl.Crypto.getOption("aes.iv");P=h.padding!=null?h.padding:jsl.Crypto.getOption("aes.padding");K=jsl.Data.Blob.toArray(N);jsl.validate(M,"si(ECB,CBC,CFB,OFB,CTR)","options.mode");jsl.validate(m,"t(s+,al,Blob)","options.iv");jsl.validate(P,"si(pkcs7,ansiX923,iso10126,zero,no)","options.padding");jsl.validate(z,"ns(128,192,256)","options.size");if(jsl.Data.Blob.toArray(m).length!==16){throw jsl.ParamError("BadValue:options.iv")}if(!jsl.Data.Blob.toArray(O).length){throw jsl.ParamError("crypto.aes.EmptyKey")}if(M.match(/ecb|cbc/i)&&K.length%16&&P=="no"){throw jsl.ParamError("crypto.aes.BadPadding:"+M)}x=this.__sbx;E=this.__rc;s=this.__0;q=this.__1;p=this.__2;o=this.__3;m=jsl.Data.Blob.toArray(m);M=M.toUpperCase();M={ECB:0,CBC:1,CFB:2,OFB:3,CTR:4}[M];i={128:4,192:6,256:8}[z];f={128:10,192:12,256:14}[z];A=this.__dec;g=m;B=[];F=jsl.Data.Blob.toArray(O);if(z/8!==F.length){F=jsl.Crypto.key(jsl.Data.Blob.toString(F),z/8).__bs}if((!M||M===1)&&P!="no"){P=this.__pad(K,P)}y=this.__ek(F,i,f);for(L=0,D=K.length;L<D;L+=16){C=L+16;I=0;if(!M){g=K.slice(L,C)}else{if(M===1){for(J=L;J<C;J++){g[I++]=K[J]^(L>=16?B[J-16]:m[J])}}else{if(M===2&&L>=16){g=(A?K:B).slice(L-16,L)}}}for(J=L,I=0;J<C;J+=4,I++){B[J]=g[I*4]^y[I][0];B[J+1]=g[I*4+1]^y[I][1];B[J+2]=g[I*4+2]^y[I][2];B[J+3]=g[I*4+3]^y[I][3]}for(J=0;J<f;J++){for(I=L;I<C;I++){B[I]=x[B[I]]}I=L+1;H=B[I];B[I]=B[I+4];B[I+4]=B[I+8];B[I+8]=B[I+12];B[I+12]=H;H=B[I+1];B[I+1]=B[I+9];B[I+9]=H;H=B[I+5];B[I+5]=B[I+13];B[I+13]=H;H=B[I+2];B[I+2]=B[I+14];B[I+14]=B[I+10];B[I+10]=B[I+6];B[I+6]=H;if(J<f-1){for(I=L;I<C;I+=4){v=B[I];u=B[I+1];t=B[I+2];r=B[I+3];B[I]=p[v]^o[u]^t^r;B[I+1]=v^p[u]^o[t]^r;B[I+2]=v^u^p[t]^o[r];B[I+3]=o[v]^u^t^p[r]}}for(I=L,H=0;I<C;I+=4,H++){B[I]^=y[H+(J+1)*4][0];B[I+1]^=y[H+(J+1)*4][1];B[I+2]^=y[H+(J+1)*4][2];B[I+3]^=y[H+(J+1)*4][3]}}if(M>1){if(M===3){g=B.slice(L,C)}else{if(M===4){m=(g[12]<<24|g[13]<<16|g[14]<<8|g[15])+1;g[12]=m>>>24&255;g[13]=m>>>16&255;g[14]=m>>>8&255;g[15]=m&255}}for(J=L;J<C;J++){B[J]^=K[J]}}}if(P>0){K.splice(K.length-P,P)}if(M>1){B.splice(B.length-(C=B.length-K.length),C)}return new jsl.Data.Blob(B)}catch(G){if(P>0){K.splice(K.length-P,P)}jsl.throwError(G,this,arguments)}};jsl.Crypto.aes.decrypt=function(L,M,j){try{var g,u,K,N,m,H,s,z,h,J,F,D,i,f,v,x,I,G,E,C,y,A,t,r,q,p,o;if(arguments.length<2||arguments.length>3){throw jsl.ParamError()}jsl.validate(L,"t(s,al,Blob)","data");jsl.validate(M,"t(s,al,Blob)","key");if(arguments.length===3){jsl.validate(j,"t(o,i++)","options")}g=jsl.isNumber(j)?{size:j}:(j||{});u=g.size!=null?g.size:jsl.Crypto.getOption("aes.size");K=g.mode!=null?g.mode:jsl.Crypto.getOption("aes.mode");m=g.iv!=null?g.iv:jsl.Crypto.getOption("aes.iv");N=g.padding!=null?g.padding:jsl.Crypto.getOption("aes.padding");jsl.validate(K,"si(ECB,CBC,CFB,OFB,CTR)","options.mode");jsl.validate(m,"t(s+,al,Blob)","options.iv");jsl.validate(N,"si(pkcs7,ansiX923,iso10126,zero,no)","options.padding");jsl.validate(u,"ns(128,192,256)","options.size");if(jsl.Data.Blob.toArray(m).length!==16){throw jsl.ParamError("BadValue:options.iv")}if(!jsl.Data.Blob.toArray(M).length){throw jsl.ParamError("crypto.aes.EmptyKey")}if(!K.search(/cfb/i)){try{this.__dec=true;v=this.encrypt.apply(this,arguments);this.__dec=false;return v}catch(B){this.__dec=false;throw B}}else{if(!K.search(/ofb|ctr/i)){return this.encrypt.apply(this,arguments)}}H=jsl.Data.Blob.toArray(L);s=this.__sbxi;z=this.__rc;h=this.__9;J=this.__B;F=this.__D;D=this.__E;m=jsl.Data.Blob.toArray(m);K=K.toUpperCase();K={ECB:0,CBC:1,CFB:2,OFB:3,CTR:4}[K];i={128:4,192:6,256:8}[u];f={128:10,192:12,256:14}[u];v=[];A=jsl.Data.Blob.toArray(M);if(u/8!==A.length){A=jsl.Crypto.key(jsl.Data.Blob.toString(A),u/8).__bs}t=this.__ek(A,i,f);for(I=0,y=H.length;I<y;I+=16){x=I+16;for(G=I,E=4*f;G<x;G+=4,E++){v[G]=H[G]^t[E][0];v[G+1]=H[G+1]^t[E][1];v[G+2]=H[G+2]^t[E][2];v[G+3]=H[G+3]^t[E][3]}for(G=f-1;G>=0;G--){E=I+1;C=v[E+12];v[E+12]=v[E+8];v[E+8]=v[E+4];v[E+4]=v[E];v[E]=C;C=v[E+1];v[E+1]=v[E+9];v[E+9]=C;C=v[E+5];v[E+5]=v[E+13];v[E+13]=C;C=v[E+2];v[E+2]=v[E+6];v[E+6]=v[E+10];v[E+10]=v[E+14];v[E+14]=C;for(E=I;E<x;E++){v[E]=s[v[E]]}for(E=I,C=0;E<x;E+=4,C++){v[E]^=t[C+G*4][0];v[E+1]^=t[C+G*4][1];v[E+2]^=t[C+G*4][2];v[E+3]^=t[C+G*4][3]}if(G){for(E=I;E<x;E+=4){r=v[E];q=v[E+1];p=v[E+2];o=v[E+3];v[E]=D[r]^J[q]^F[p]^h[o];v[E+1]=h[r]^D[q]^J[p]^F[o];v[E+2]=F[r]^h[q]^D[p]^J[o];v[E+3]=J[r]^F[q]^h[p]^D[o]}}}if(K===1){for(G=I;G<x;G++){v[G]^=(I>=16?H[G-16]:m[G])}}}if(N!="no"){this.__unpad(v,N)}return new jsl.Data.Blob(v)}catch(B){jsl.throwError(B,this,arguments)}};jsl.Crypto.aes.__ek=function(g,c,i){var m,j,o,b,h,d,f;m=[];b=this.__rc;h=this.__sbx;for(j=0;j<c;j++){m[j]=g[4*j]<<24|g[4*j+1]<<16|g[4*j+2]<<8|g[4*j+3]}d=4*(i+1);while(j<d){o=m[j-1];if(!(j%c)){o=o<<8|o>>>24;o=h[o>>>24]<<24|h[o>>>16&255]<<16|h[o>>>8&255]<<8|h[o&255];o=o^b[j/c]}else{if(c>6&&j%c===4){o=h[o>>>24]<<24|h[o>>>16&255]<<16|h[o>>>8&255]<<8|h[o&255]}}m[j]=m[j++-c]^o}for(j=0,f=m.length;j<f;j++){m[j]=[m[j]>>>24,m[j]>>>16&255,m[j]>>>8&255,m[j]&255]}return m};jsl.Crypto.aes.__pad=function(b,a){var d,c;d=c=16-b.length%16;switch(a){case"pkcs7":while(c--){b.push(d)}break;case"ansix923":while(--c){b.push(0)}b.push(d);break;case"iso10126":while(--c){b.push(Math.round(Math.random()*255))}b.push(d);break;case"zero":while(c--){b.push(0)}}return d};jsl.Crypto.aes.__unpad=function(b,a){var d,c;switch(a){case"pkcs7":case"ansix923":case"iso10126":d=b[b.length-1];/*!*/if(isNaN(d)||d>16){throw jsl.ConfigError("crypto.aes.DecryptError")}/*!*/b.splice(b.length-d,d);break;case"zero":d=c=b.length-1;while(b[c]===0){c--}d-=c;b.splice(b.length-d,d)}}};'